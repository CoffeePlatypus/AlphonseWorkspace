package hw5;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

import javax.lang.model.element.UnknownAnnotationValueException;


public class Prestidigitation implements Digits {
	private ArrayList<Integer> digits = new ArrayList<Integer>(); // NO OTHER VARIABLES

 //constructors
	public Prestidigitation (int num) throws IllegalArgumentException {
		try{
			if(num==0) {
				digits.add(0);
			}else{
				while(num!=0) {
					digits.add(num%10);
					num=num/10;
				}
			}
		}catch (IllegalArgumentException e1) {
			
		}
		
	}
 
	public Prestidigitation (String num) throws NumberFormatException {
		
		while(num.length()>0) {
			
		}
	 
	}
 
	public Prestidigitation (long num) throws IllegalArgumentException {
		if(num==0) {
			digits.add(0);
		}else{
			while(num!=0) {
				digits.add((int)num%10);
				num=num/10;
			}
		}
	}
 
	public Prestidigitation (Prestidigitation num) throws IllegalArgumentException {
		digits=num.digits;
	}
	
	public Prestidigitation (ArrayList<Integer> num) throws IllegalArgumentException {
		digits=num;
	}
	
	public ArrayList<Integer> getTheDigits() {
		return digits;
	}
 
 //Overriding methods
	public int compareTo(Digits arg0) {
		return 0;
	}
	
	public Digits add(Digits other) throws IllegalArgumentException {
		if(other instanceof Prestidigitation) {
			int carry=0;
			ArrayList<Integer> sum = new ArrayList<Integer>();
			Iterator<Integer> dIterator = getDigits(true);
			Iterator<Integer> oIterator = other.getDigits(true);
			while(dIterator.hasNext() && oIterator.hasNext()) {
				int sumnums=(dIterator.next()+oIterator.next()+carry);
				sum.add((sumnums)%10);
				carry=sumnums/10;
			}
			while(dIterator.hasNext()) {
				sum.add(dIterator.next());
			}
			while(oIterator.hasNext()) {
				sum.add(oIterator.next());
			}
			Digits result=new Prestidigitation(sum);
			return result;
		}else{
			throw new IllegalArgumentException();
		}
	}			

	public Digits mul(Digits other) throws IllegalArgumentException {
		if(other instanceof Prestidigitation) {
			int carry=0, i=0;
			ArrayList<ArrayList<Integer>> product =new ArrayList<ArrayList<Integer>>();
			Iterator<Integer> dIterator = getDigits(true);
			Iterator<Integer> oIterator = other.getDigits(true);
			while(oIterator.hasNext()) {
				int zeros=i,next=oIterator.next();
				ArrayList<Integer> line = new ArrayList<Integer>();
				while(zeros>0) {
					line.add(0);
					zeros--;
				}
				i++;
				while(dIterator.hasNext()) {
					int mulnums=(dIterator.next()*next)+carry;
					System.out.println("m"+ mulnums);
					line.add((mulnums)%10);
					carry=mulnums/10;
					System.out.println("c"+carry);
				}
				if(carry!=0) {
					line.add(carry);
				}
				product.add(line);
				System.out.println(i);
			}
			Prestidigitation sum = new Prestidigitation(product.get(0));
			for(int k=1; k<product.size(); k++) {
				Prestidigitation atK= new Prestidigitation(product.get(k));
				System.out.println("at k"+atK.toSting());
				sum=new Prestidigitation((Prestidigitation)(sum.add(atK)));
				System.out.println("Sum"+sum.toSting());
			}
			Digits result=sum;
			return result;
		}else{
			throw new IllegalArgumentException();
		}
	}
	public Digits pow(Digits other) throws IllegalArgumentException, UnknownAnnotationValueException {
		if(other instanceof Prestidigitation) {
			if(isZero() && other.isZero()) {
				return
			}else if(!isZero() && other.isZero()) {
				Digits result=new Prestidigitation(1);
				return result;
			}else if(other.isOne()) {
				Digits result= new Prestidigitation(digits);
				return result;
			}else{
				ArrayList<Integer> half=new ArrayList<Integer>();
				half=other.half()
			}
		}
	}
	
	private class PrestidigIterator implements Iterator<Integer> {
		int nextIndex;
		boolean leastFirst;
		
		public PrestidigIterator(boolean lf) {
			leastFirst=lf;
			if(leastFirst) {
				nextIndex=0;
			}else{
				nextIndex=numberOfDigits()-1;
			}
		}

		public boolean hasNext() {
			if(leastFirst) {
				return nextIndex<numberOfDigits();
			}else{
				return nextIndex>=0;
			}
		}

		public Integer next() {
			if(leastFirst) {
				return digits.get(nextIndex++);
			}else{
				return digits.get(nextIndex--);
			}
		}

		public void remove() {
			throw new UnsupportedOperationException();

		}
	}
	public Iterator<Integer> getDigits(boolean leastFirst) {
		return new PrestidigIterator(leastFirst);
	}

	public boolean isZero() {
		return digits.get(0)==0 && digits.size()==1;
	}

	public boolean isOne() {
		return digits.get(0)==1 && digits.size()==1;
	}

	public Digits half() {
		digits.add(0,0);
		ArrayList<Integer> half=new ArrayList<Integer>();
		for(int i=0; i<digits.size();i=i+2) {
			if((digits.get(i)%2)==0) {
				switch (digits.get(i+1)) {
					case 0: case 1: half.add(0); break;
					case 2: case 3: half.add(1); break;
					case 4: case 5: half.add(2); break;
					case 6: case 7: half.add(3); break;
					case 8: case 9: half.add(4); break;
				}				
			}else{
				switch (digits.get(i+1)) {
				case 0: case 1: half.add(5); break;
				case 2: case 3: half.add(6); break;
				case 4: case 5: half.add(7); break;
				case 6: case 7: half.add(8); break;
				case 8: case 9: half.add(9); break;
				}
			}	
		}
		half.remove(0);
		Digits result=new Prestidigitation(half);
		return result;
	}

	public boolean isEven() {
		return digits.get(0)%2==0;
	}

	public int numberOfDigits() {
		return digits.size();
	}
	public boolean equals(Object other){
		if(other instanceof Prestidigitation) {
			if(numberOfDigits()==((Prestidigitation) other).numberOfDigits()) {
				Iterator<Integer> dIterator = getDigits(true);
				Iterator<Integer> oIterator = ((Prestidigitation) other).getDigits(true);
				while(dIterator.hasNext() && oIterator.hasNext()) {
					if(dIterator.next()!= oIterator.next()) {
						return false;
					}
				}
				return true;
			}
		}
		return false;
	}
	public String toSting() {
		Iterator<Integer> dIterator = getDigits(false);
		String number="";
		while(dIterator.hasNext()) {
			number=number+dIterator.next();
		}
		return number;
	}
}